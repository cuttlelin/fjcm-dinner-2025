<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¼”å¤§ç®¡é™¢æ ¡å‹æ™šå®´ - äº’å‹•å•ç­”</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>

<div class="container">
    <header>
        <h1>ğŸ“ è¼”å¤§ç®¡é™¢æ ¡å‹æ™šå®´</h1>
        <p>æ­¡è¿å›å®¶ï¼è«‹ç•™ä¸‹æ‚¨çš„æƒ³æ³•</p>
    </header>

    <div class="card">
        <form id="alumForm">
            <label for="impression">1. å°è¼”å¤§å°è±¡æœ€æ·±åˆ»çš„æ˜¯ä»€éº¼ï¼Ÿ</label>
            <input type="text" id="impression" placeholder="ä¾‹å¦‚ï¼šä¸­ç¾å ‚ã€å¤§è è˜¿ã€ä¿®å¥³..." required>
            
            <label for="message">2. æœ€æƒ³è·Ÿè¼”å¤§åŠç®¡é™¢èªªçš„è©±</label>
            <textarea id="message" rows="4" placeholder="å¯«ä¸‹æ‚¨çš„ç¥ç¦æˆ–æ˜¯å›æ†¶..." required></textarea>
            
            <button type="submit">é€å‡ºç•™è¨€</button>
        </form>
    </div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";

  // TODO: è«‹åœ¨æ­¤è™•è²¼ä¸Šæ‚¨çš„ Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyDWWXuU16UwB8iXo5tEVuzYYVP9ppslisk",
	authDomain: "fjcu-dinner.firebaseapp.com",
	projectId: "fjcu-dinner",
	storageBucket: "fjcu-dinner.firebasestorage.app",
	messagingSenderId: "461813917984",
	appId: "1:461813917984:web:717f2404d20dd9a0d68f45",
	measurementId: "G-9TQS9R3CDC"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  document.getElementById('alumForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const impression = document.getElementById('impression').value;
      const message = document.getElementById('message').value;
      const btn = e.target.querySelector('button');

      btn.textContent = 'å‚³é€ä¸­...';
      btn.disabled = true;

      try {
          await addDoc(collection(db, "responses"), {
              impression: impression,
              message: message,
              timestamp: serverTimestamp()
          });
          alert("æ”¶åˆ°æ‚¨çš„ç•™è¨€äº†ï¼è¬è¬å­¸é•·å§ï¼");
          document.getElementById('alumForm').reset();
          btn.textContent = 'é€å‡ºç•™è¨€';
          btn.disabled = false;
      } catch (err) {
          console.error("Error", err);
          alert("ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦");
          btn.textContent = 'é€å‡ºç•™è¨€';
          btn.disabled = false;
      }
  });
</script>

</body>
</html>